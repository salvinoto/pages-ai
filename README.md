# Page-AI SDK

Page-AI enables AI agents to interact with web applications by providing a structured way to describe UI elements and actions, observe DOM changes, and execute commands. It aims to bridge the gap between AI models and the dynamic nature of web interfaces.

## Packages

This monorepo contains the following packages:

*   `@page-ai/core`: Core engine, command definitions, selector DSL, and Edge compatibility.
*   `@page-ai/dom`: DOM serialization and MutationObserver-based diffing.
*   `@page-ai/react`: React integration components and hooks.

## Installation

Install the necessary packages using your preferred package manager. For example, with Bun:

```bash
bun add @page-ai/react @page-ai/core @page-ai/dom
```

## Development Commands

This section details the scripts available in the root `package.json` for common development tasks:

*   **`bun run build`**: Builds all packages (`@page-ai/core`, `@page-ai/dom`, `@page-ai/react`) sequentially. This process compiles the source code (TypeScript) into distributable JavaScript files, typically placing them in the `dist` directory within each package.

*   **`bun run add-changeset`**: Initiates the [Changesets](https://github.com/changesets/changesets) workflow to document changes (e.g., bug fixes, new features) intended for the next release. It interactively prompts you to select the packages affected by your changes and provide a description. This creates a unique markdown file in the `.changeset` directory detailing the change.

*   **`bun run version`**: Consumes the markdown files generated by `bun run add-changeset`. It automatically calculates the next appropriate semantic version (SemVer) for each affected package based on the changesets, updates the `version` field in their respective `package.json` files, and updates the `CHANGELOG.md` file for each package.

*   **`bun run publish`**: Publishes the packages to the NPM registry. This command first executes the `bun run build` script to ensure the latest code is built. Then, it publishes only the packages that have been versioned (by `bun run version`) since the last publish. *Note: Requires you to be logged into NPM (`npm login`) with appropriate permissions.*

*   **`bun run dev`**: Currently a placeholder script (`echo "Starting dev..."`). This can be configured to run a specific development workflow, such as starting a local development server for a demo application, watching files for changes and rebuilding, or other common development tasks.

*   **`bun run lint`**: Runs ESLint across the entire monorepo (`.ts` and `.tsx` files). This checks the code for potential errors, enforces code style consistency, and helps maintain code quality according to the rules defined in the ESLint configuration (`.eslintrc.js`).

*   **`bun run test`**: Executes the Jest test suite for all packages. It looks for test files (typically `*.test.ts` or `*.test.tsx`) within each package and runs the tests defined within them, reporting the results.
## Release Process (Using Changesets)

This project uses [Changesets](https://github.com/changesets/changesets) to manage versioning, changelogs, and publishing. Follow these steps to prepare and publish a new release:

1.  **Make Code Changes:** Implement your features, bug fixes, or other changes in the relevant package(s).
2.  **Ensure Quality:**
    *   Run tests to confirm your changes haven't introduced regressions:
        ```bash
        bun run test
        ```
    *   Run the linter to check for code style issues:
        ```bash
        bun run lint
        ```
    *   Address any failures before proceeding.
3.  **Document Changes:** For *each* distinct feature or fix that should be included in the release notes, run:
    ```bash
    bun run add-changeset
    ```
    *   Follow the prompts: Select the package(s) affected by the change.
    *   Choose the appropriate SemVer bump (patch, minor, major) for each package.
    *   Write a clear, concise description of the change. This description will appear in the `CHANGELOG.md`.
    *   Repeat this step for all individual changes you want to document.
4.  **Commit Changesets:** Add the generated markdown files in the `.changeset` directory to Git:
    ```bash
    git add .changeset/
    git commit -m "docs: add changesets for upcoming release"
    ```
5.  **Version Packages:** Run the version command to consume the changesets, update package versions, and generate changelogs:
    ```bash
    bun run version
    ```
    *   This command updates the `version` field in the `package.json` of affected packages and updates their `CHANGELOG.md` files.
6.  **Review and Commit Versioning:**
    *   Review the changes made to `package.json` files and `CHANGELOG.md` files to ensure they are correct.
    *   Commit these changes:
        ```bash
        git add packages/*/package.json packages/*/CHANGELOG.md .changeset/pre.json # Add other relevant files if needed
        git commit -m "chore: bump versions and update changelogs"
        ```
7.  **Tag Release (Optional but Recommended):** Create a Git tag for the release. It's common practice to tag with the version of the primary package or a general release tag.
    ```bash
    # Example: git tag v1.2.3
    # git push --tags
    ```
8.  **Publish Packages:** Build the packages and publish the newly versioned ones to NPM:
    ```bash
    bun run publish
    ```
    *   Ensure you are logged into NPM (`npm login`) with the necessary permissions.

This process ensures that versions are bumped correctly based on the documented changes and that changelogs are automatically generated.